#!/usr/bin/env node

var program = require('commander');
// var spawn = require('child_process').spawn;
var exec = require('child_process').exec;
var path = require('path');

// console.log(path.resolve(path.join(__dirname,'lib/gist2png.js')));
var script = path.resolve(__dirname, '../lib/gist2png.js');

var url = process.argv[2];
var name = process.argv[3];

program.version('0.1').option('-f --format <n>', 'image format png | jpeg | gif | pdf');

console.log(url, name);

a = exec("phantomjs "+script+" "+url+" temp.png", function(err, message){
  if(err){process.stderr(err);}
  exec("convert -trim -fuzz 10% -border %1x1% -bordercolor '#fff' temp.png "+name, function(){
    if(err){process.stderr(err);}
    exec("rm temp.png", function(){
      process.exit();
    });
  });
});
